>fviz_nbclust(CA1, hcut, method = "wss") +
geom_vline(xintercept = 3, linetype = 2)+
labs(subtitle = "Elbow method")

#drei cluster?
> options(stringsAsFactors = FALSE)

> fviz_nbclust(CA1, hcut, method = "silhouette")+
labs(subtitle = "Silhouette method")
#zwei Cluster?

> d1 <- dist(CA1, method = 'euclidean')
> head(as.matrix(d1))

#Cluster Dendogramm

> hc.compl <- hclust(d1, method="complete")
> fviz_dend(hc.compl)

# Versuch mit PCA -> geht nicht weil BerufHEB nicht quantitativ ist
CA_means.pca <- PCA(CAmeans,
scale.unit = F,
ncp = 5,
graph = F)

> corrplot(CA1, is.corr=FALSE) # unübersichtlich

# Gap statistic (maximum)
fviz_nbclust(CA1, kmeans, nstart = 4,  method = "gap_stat", nboot = 500)

# Dendogramm mit vier Cluster
> fviz_dend(hc.compl,4)

# Clustersulution
cluster <- cutree(hc.compl, k = 4)
head(cluster)

# k-means
> d1.k <- kmeans(d1, 
 4, 
 iter.max = 10, 
 nstart = 2)
print(d1.k)
> d1.k$cluster

#Clusterplot

fviz_cluster(data = d1,
+ d1.k)

# Cluster 1 und 3 sind sehr deckend also doch besser 3 cluster

#Dedogramm mit drei Clustern

>  fviz_dend(hc.compl,3)

#Clustersulution mit 3 Clustern
> cluster <- cutree(hc.compl, k = 3)
> head(cluster)

# k-means mit 3 Clustern

> d1.k <- kmeans(d1, 
3, 
iter.max = 10, 
nstart = 2)
print(d1.k)
> d1.k$cluster

#Clusterplot mit drei Dimensionen

fviz_cluster(data = d1,
+ d1.k)
#viel besser!

aggregate(d1, by=list(cluster=d1$cluster), mean)
# Fehlermeldung: Error in as.data.frame.default(x) : 
  cannot coerce class ‘"dist"’ to a data.frame
  Ich glaube wir müssen d1 in ein data-frame umwandeln. Mir bisher leider nicht gelungen
